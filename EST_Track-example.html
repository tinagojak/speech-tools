<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Edinburgh Speech Tools: EST_Track class example code</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="est.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Edinburgh Speech Tools
   &#160;<span id="projectnumber">2.1-release</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('EST_Track-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="classEST__Track.html">EST_Track</a> class example code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#initializing">Initialising and Resizing a Track</a></li>
<li class="level1"><a href="#simple_access">Simple Access</a></li>
<li class="level1"><a href="#est_trac_naming_channels">Naming Channels</a></li>
<li class="level1"><a href="#tr_example_access_single_frames">Access single frames or single channels.</a></li>
<li class="level1"><a href="#tr_example_access_multiple_frames">Access multiple frames or channels.</a></li>
<li class="level1"><a href="#auxiliary">Auxiliary Channels</a></li>
<li class="level1"><a href="#file_i_o">File I/O</a></li>
</ul>
</div>
<div class="textblock"><p>Some examples of track manipulations. <h1><a class="anchor" id="initializing"></a>
Initialising and Resizing a Track</h1>
<p>The constructor functions can be used to create a track with zero frames and channels or a track with a specified number of frames and channels</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__Track.html">EST_Track</a> tr;           <span class="comment">// default track declaration</span></div><div class="line">    <a class="code" href="classEST__Track.html">EST_Track</a> tra(500, 10); <span class="comment">// allocate track with 500 frames and 10 channels</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>tracks can be resized at any time:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">resize</a>(10, 500); <span class="comment">// resize track to have 10 frames and 500 channels</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">resize</a>(500, 10); <span class="comment">// resize track to have 500 frames and 10 channels</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>by default, resizing preserves values in the track. This may involve copying some information, so if the existing values are not needed, a flag can be set which usually results in quicker resizing</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">resize</a>(250, 5, 0);  <span class="comment">// throw away any existing values</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>If only the number of channels or the number of frames needs to be changed, this an be done with the following functions: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a9de0b3f468b601a7c90ca0e80c6a008c">set_num_channels</a>(10);   <span class="comment">// makes 10 channels, keeps same no of frames</span></div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a7874320881a266dadd2e09fd15d1da8d">set_num_frames</a>(400);    <span class="comment">// makes 400 frames, keeps same no of channels</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>The preserve flag works in the same way with these functions</p>
<h1><a class="anchor" id="simple_access"></a>
Simple Access</h1>
<p>Values in the track can be accessed and set by frame number and channel number.</p>
<p>The following resizes a track to have 500 frames and 10 channels and fills every position with -5.</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">resize</a>(500, 10); </div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; tr.<a class="code" href="classEST__Track.html#a7ada30a39482a529fd3bf215c3361548">num_frames</a>(); ++i)</div><div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; tr.<a class="code" href="classEST__Track.html#adcf56a7204cb8f8fcaf8059d7cc1e75e">num_channels</a>(); ++j)</div><div class="line">        tr.<a class="code" href="classEST__Track.html#a7e810b90df281e76e35e3b7b9a1e9ac1">a</a>(i, j) = -5.0;</div><div class="line"></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>A well formed track will have a time value, specified in seconds, for every frame. The time array can be filled directly:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; tr.<a class="code" href="classEST__Track.html#a7ada30a39482a529fd3bf215c3361548">num_frames</a>(); ++i)</div><div class="line">    tr.<a class="code" href="classEST__Track.html#ad59d5765b4df75ebf737076dfdcd07c6">t</a>(i) = (float) i * 0.01;</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>which fills the time array with values 0.01, 0.02, 0.03... 5.0. However, A shortcut function is provided for fixed frame spacing: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ad9c8a2d32cf0a2936ae475ba3a945d03">fill_time</a>(0.1);</div><div class="line"></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>which performs the same operation as above. Frames do not have to be evenly spaced, in pitch synchronous processing the time array holds the time position of each pitch period. In such cases each position in the time array must obviously be set individually.</p>
<p>Some representations have undefined values during certain sections of the track, for example the F0 value during unvoiced speech.</p>
<p>The break/value array can be used to specify if a frame has an undefined value.</p>
<p>If a frame in this array is 1, that means the amplitude is defined at that point. If 0, the amplitude is undefined. By default, every frame has a value.</p>
<p>Breaks (undefined values) can be set by <a class="el" href="classEST__Track.html#ab2ea4d5cfff670ecda19d52ad5360047" title="set frame i to be a break ">EST_Track::set_break()</a>. The following sets every frame from 50 to 99 as a break:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">for</span> (i = 50; i &lt; 100; ++i)</div><div class="line">        tr.<a class="code" href="classEST__Track.html#ab2ea4d5cfff670ecda19d52ad5360047">set_break</a>(i);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>frames can be turned back to values as follows:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">for</span> (i = 50; i &lt; 100; ++i)</div><div class="line">        tr.<a class="code" href="classEST__Track.html#ad3f37ce906106b15caf08cd992f61828">set_value</a>(i);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>It is up to individual functions to decide how to interpret breaks.</p>
<p>A frame's status can be checked as follows:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">if</span> (tr.<a class="code" href="classEST__Track.html#a3b279eca1aa2e7a2114280323b941a6e">val</a>(60))</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Frame 60 is not a break\n&quot;</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (tr.<a class="code" href="classEST__Track.html#a07ad77b30697a22fc3ad49bfa3133b60">track_break</a>(60))</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Frame 60 is a break\n&quot;</span>;</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<h1><a class="anchor" id="est_trac_naming_channels"></a>
Naming Channels</h1>
<p>While channels can be accessed by their index, it is often useful to give them names and refer to them by those names.</p>
<p>The <a class="el" href="classEST__Track.html#a3e6a131c775d37c416d42ceac8d4d009" title="set the name of the channel. ">EST_Track::set_channel_name()</a> function sets the name of a single channel:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a3e6a131c775d37c416d42ceac8d4d009">set_channel_name</a>(<span class="stringliteral">&quot;F0&quot;</span>, 0); </div><div class="line">    tr.<a class="code" href="classEST__Track.html#a3e6a131c775d37c416d42ceac8d4d009">set_channel_name</a>(<span class="stringliteral">&quot;energy&quot;</span>, 1); </div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>An alternative is to use a predefined set of channel names stored in a <em>map</em>. A track map is simply a String List strings which describe a channel name configuration. The <a class="el" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">EST_Track::resize</a> function can take this and resize the number of channels to the number of channels indicated in the map, and give each channel its name from the map. For example: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__TList.html">EST_StrList</a> map;</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;F0&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;energy&quot;</span>);</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">resize</a>(500, map); <span class="comment">// this makes a 2 channel track and sets the names to F0 and energy</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>A convention is used for channels which comprise components of a multi-dimensional analysis such as cepstra. In such cases the channels are named <code>TYPE_I</code>. The last coefficient is always names <code>TYPE_N</code> regardless of the number of coefficients. This is very useful in extracting a set of related channels without needing to know the order of the analysis.</p>
<p>For example, a track map might look like:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line"></div><div class="line">    map.<a class="code" href="classEST__TList.html#a3dac6678c648eb208e3bd492c48e56ce">clear</a>();</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;F0&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;energy&quot;</span>);</div><div class="line"></div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_0&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_1&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_2&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_3&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_4&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_5&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_6&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_7&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cep_N&quot;</span>);</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">resize</a>(500, map); <span class="comment">// makes a 11 channel track and sets the names</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>This obviously gets unwieldy quite quickly, so the mapping mechanism provides a short hand for multi-dimensional data.</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    map.<a class="code" href="classEST__TList.html#a3dac6678c648eb208e3bd492c48e56ce">clear</a>();</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;F0&quot;</span>);</div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;energy&quot;</span>);</div><div class="line"></div><div class="line">    map.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;$cep-0+8&quot;</span>);</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#ab3894e5ae5607df6cb3db245d4dd6d57">resize</a>(500, map); <span class="comment">// does exactly as above</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>Here $ indicates the special status, "cep" the name of the coefficients, "-0" that the first is number 0 and "+8" that there are 8 more to follow.</p>
<h1><a class="anchor" id="tr_example_access_single_frames"></a>
Access single frames or single channels.</h1>
<p>Often functions perform their operations on only a single frame or channel, and the track class provides a general mechanism for doing this.</p>
<p>Single frames or channels can be accessed as <a class="el" href="classEST__FVector.html" title="A vector class for floating point numbers. EST_FVector x should be used instead of float *x wherever ...">EST_FVector</a> : Given a track with 500 frames and 10 channels, the 50th frame can be accessed as: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__FVector.html">EST_FVector</a> tmp_frame;</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#af0a76a2a8cda0fc9ba03b2d2ae9452c3">frame</a>(tmp_frame, 50);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>now <code>tmp_frame</code> is 10 element vector, which is a window into <code>tr</code>: any changes to the contents of <code>tmp_frame</code> will change <code>tr</code>. <code>tmp_frame</code> cannot be resized. (This operation can be thought in standard C terms as <code>tmp_frame</code> being a pointer to the 5th frame of <code>tr</code>).</p>
<p>Likewise with channels:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__FVector.html">EST_FVector</a> tmp_channel;</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a0abe4c2dd99dac91aa335ed5b56808a2">channel</a>(tmp_channel, 5);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>Again, <code>tmp_channel</code> is 500 element vector, which is a window into <code>tr</code>: any changes to the contents of <code>tmp_channel</code> will change <code>tr</code>. <code>tmp_channel</code> cannot be resized.</p>
<p>Channels can also be extracted by name:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a0abe4c2dd99dac91aa335ed5b56808a2">channel</a>(tmp_channel, <span class="stringliteral">&quot;energy&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>not all the channels need be put into the temporary frame. Imagine we have a track with a F0 channel,a energy channel and 10 cepstrum channels. The following makes a frame from the 50th frame, which only includes the cepstral information in channels 2 through 11</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#af0a76a2a8cda0fc9ba03b2d2ae9452c3">frame</a>(tmp_frame, 50, 2, 9);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a0abe4c2dd99dac91aa335ed5b56808a2">channel</a>(tmp_channel, 5, 400, 100);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<h1><a class="anchor" id="tr_example_access_multiple_frames"></a>
Access multiple frames or channels.</h1>
<p>In addition to extracting single frames and channels, multiple frame and channel portions can be extracted in a similar way. In the following example, we make a sub-track sub, which points to the entire cepstrum portion of a track (channels 2 through 11)</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__Track.html">EST_Track</a> <a class="code" href="vec__mat__aux_8cc.html#ab91c212e0b0b9074dd90968ec632139d">sub</a>;</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a8cd00db6b78d956b6db85113e208e7a0">sub_track</a>(sub, 0, <a class="code" href="EST__matrix__support_8cc.html#ae0e0794f05426f5bbe78228f746cc4b3">EST_ALL</a>, 2, 9);</div><div class="line"></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>Parameter <code>sub</code> behaves exactly like a normal track in every way, except that it cannot be resized. Its contents behave like a point into the designated portion of <code>tr</code>, so changing <code>sub</code> will change <code>tr</code>.</p>
<p>The first argument is the <code>sub</code> track. The second states the start frame and the total number of frames required. EST_ALL is a special constant that specifies that all the frames are required here. The next argument is the start channel number (remember channels are numbered from 0), and the last argument is the total number of channels required.</p>
<p>This facility is particularly useful for using standard signal processing functions efficiently. For example, the <a class="el" href="group__Functionsforusewithframebasedprocessing.html#gaf55931ec4d21404a232c0ee804c917f4">melcep</a> in the signal processing library takes a waveform and produces a mel-scale cepstrum. It determines the order of the cepstral analysis by the number of channels in the track it is given, which has already been allocated to have the correct number of frames and channels.</p>
<p>The following will process the waveform <code>sig</code>, produce a 10th order mel cepstrum and place the output in <code>sub</code>. (For explanation of the other options see <a class="el" href="group__Functionsforusewithframebasedprocessing.html#gaf55931ec4d21404a232c0ee804c917f4">melcep</a></p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__Wave.html">EST_Wave</a> sig;</div><div class="line"></div><div class="line">    <a class="code" href="group__Functionsforusewithframebasedprocessing.html#gaf55931ec4d21404a232c0ee804c917f4">melcep</a>(sig, sub, 1.0, 20, 22); </div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>because we have made <code>sub</code> a window into <code>tr</code>, the melcep function writes its output into the correct location, i.e. channels 2-11 of tr. If it were no for the sub_track facility, either a separate track of the right size would be passed into melcep and then it would be copied into tr (wasteful), or else tr would be passed in and other arguments would have to specify which channels should be written to (messy).</p>
<p>Sub-tracks can also be set using channel names. The following example does exactly as above, but is referenced by the name of the first channel required and the number of channels to follow:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a8cd00db6b78d956b6db85113e208e7a0">sub_track</a>(sub, 0, <a class="code" href="EST__matrix__support_8cc.html#ae0e0794f05426f5bbe78228f746cc4b3">EST_ALL</a>, <span class="stringliteral">&quot;cep_0&quot;</span>, <span class="stringliteral">&quot;cep_N&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>and this specifies the end by a string also:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a8cd00db6b78d956b6db85113e208e7a0">sub_track</a>(sub, 0, <a class="code" href="EST__matrix__support_8cc.html#ae0e0794f05426f5bbe78228f746cc4b3">EST_ALL</a>, <span class="stringliteral">&quot;cep_0&quot;</span>, <span class="stringliteral">&quot;cep_N&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>sub_tracks can be any set of continuous frames and channels. For example if a word started at frame 43 and ended and frame 86, the following would set a sub track to that portion: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a8cd00db6b78d956b6db85113e208e7a0">sub_track</a>(sub, 47, 39, <span class="stringliteral">&quot;cep_0&quot;</span>, <span class="stringliteral">&quot;cep_N&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>We can step through the frames of a Track using a standard iterator. The frames are returned as one-frame sub-tracks.</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__TIterator.html">EST_Track::Entries</a> frames;</div><div class="line"></div><div class="line">    <span class="comment">// print out the time of every 50th track</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Times:&quot;</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (frames.<a class="code" href="classEST__TIterator.html#a3e4224f5d84ca10fb51fb88cfe7dd9d4">begin</a>(tr); frames; ++frames)</div><div class="line">      {</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classEST__Track.html">EST_Track</a> &amp;frame = *frames;</div><div class="line">    <span class="keywordflow">if</span> (frames.<a class="code" href="classEST__TIterator.html#abc6cbb307d61cd6f7a9ddf0b4697e50e">n</a>() % 50 ==0)</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; frames.<a class="code" href="classEST__TIterator.html#abc6cbb307d61cd6f7a9ddf0b4697e50e">n</a>() &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; frame.<a class="code" href="classEST__Track.html#ad59d5765b4df75ebf737076dfdcd07c6">t</a>() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div><div class="line">    }</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">       </div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>The <a class="el" href="classEST__Track.html#a0abe4c2dd99dac91aa335ed5b56808a2">EST_Track::channel</a>, <a class="el" href="classEST__Track.html#af0a76a2a8cda0fc9ba03b2d2ae9452c3">EST_Track::frame</a> and <a class="el" href="classEST__Track.html#a8cd00db6b78d956b6db85113e208e7a0">EST_Track::sub_track</a> functions are most commonly used to write into a track using a convenient sub-portion. Sometimes, however a simple copy is required whose contents can be written without affecting the original.</p>
<p>The <a class="el" href="classEST__Track.html#a5d916090a3989e8505997607e2b9d9af">EST_Track::copy_sub_track</a> function does this <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__Track.html">EST_Track</a> tr_copy;</div><div class="line">    </div><div class="line"><span class="comment">//    tr.copy_sub_track(tr_copy, 47, 39, &quot;cep_0&quot;, &quot;cep_N&quot;);</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>Individual frames and channels can be copied out into pre-allocated float * arrays as follows:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordtype">float</span> *channel_buf, *frame_buf;</div><div class="line">    channel_buf = <span class="keyword">new</span> <span class="keywordtype">float</span>[tr.<a class="code" href="classEST__Track.html#a7ada30a39482a529fd3bf215c3361548">num_frames</a>()];</div><div class="line">    frame_buf = <span class="keyword">new</span> <span class="keywordtype">float</span>[tr.<a class="code" href="classEST__Track.html#adcf56a7204cb8f8fcaf8059d7cc1e75e">num_channels</a>()];</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#acfc51980da1cacfda41a5f6095615d55">copy_channel_out</a>(5, channel_buf);   <span class="comment">// copy channel 5 into channel_buf</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a12e3afcfa8506259e45fa0e5a4eddee0">copy_frame_out</a>(43, frame_buf);      <span class="comment">// copy frame 4 into frame_buf</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>Individual frames and channels can be copied into the track from float * arrays as follows:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a40a0230233c6f8b02e843235cba7a6ba">copy_channel_in</a>(5, channel_buf);    <span class="comment">// copy channel_buf into channel 5 </span></div><div class="line">    tr.<a class="code" href="classEST__Track.html#a1fae9b708f2b16899629a863fbdd4c42">copy_frame_in</a>(43, frame_buf);       <span class="comment">// copy frame_buf into frame 4</span></div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<h1><a class="anchor" id="auxiliary"></a>
Auxiliary Channels</h1>
<p>Auxiliary channels are used for storing frame information other than amplitude coefficients, for example voicing decisions and points of interest in the track.</p>
<p>Auxiliary channels always have the same number of frames as the amplitude channels. They are resized by assigning names to the channels that need to be created:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__TList.html">EST_StrList</a> aux_names;</div><div class="line"></div><div class="line">    aux_names.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;voicing&quot;</span>);</div><div class="line">    aux_names.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;join_points&quot;</span>);</div><div class="line">    aux_names.<a class="code" href="classEST__TList.html#a4796ddc854ff93fd7f86acd86b9e21a1">append</a>(<span class="stringliteral">&quot;cost&quot;</span>);</div><div class="line"></div><div class="line">    tr.<a class="code" href="classEST__Track.html#aac924bd760f8f893ee3b49f0b58a449b">resize_aux</a>(aux_names);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>The following fills in these three channels with some values: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; 500; ++i)</div><div class="line">    {</div><div class="line">    tr.<a class="code" href="classEST__Track.html#a7bc314ae3137c2251b47e625fed44d0c">aux</a>(i, <span class="stringliteral">&quot;voicing&quot;</span>) = i;</div><div class="line">    tr.<a class="code" href="classEST__Track.html#a7bc314ae3137c2251b47e625fed44d0c">aux</a>(i, <span class="stringliteral">&quot;join_points&quot;</span>) = <a class="code" href="EST__features__aux_8cc.html#afa02c4bbe9aa0e833dda8da46564fb3a">EST_String</a>(<span class="stringliteral">&quot;stuff&quot;</span>);</div><div class="line">    tr.<a class="code" href="classEST__Track.html#a7bc314ae3137c2251b47e625fed44d0c">aux</a>(i, <span class="stringliteral">&quot;cost&quot;</span>) =  0.111;</div><div class="line">    }</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<h1><a class="anchor" id="file_i_o"></a>
File I/O</h1>
<p>Tracks in various formats can be saved and loaded:</p>
<p>Save as a HTK file:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">if</span> (tr.<a class="code" href="classEST__Track.html#a626317b6dddbebc517a40eb546381cba">save</a>(<span class="stringliteral">&quot;tmp/track.htk&quot;</span>, <span class="stringliteral">&quot;htk&quot;</span>) != <a class="code" href="EST__rw__status_8h.html#a2e09b4ded8fd265d4fb01e3c93e64312a317dc678bf3950bde0350d7f1044c024">write_ok</a>)</div><div class="line">    <a class="code" href="EST__error_8h.html#a77e7718a22033561ee47f8b28b12acac">EST_error</a>(<span class="stringliteral">&quot;can&#39;t save htk file\n&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>Save as a EST file:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">if</span> (tr.<a class="code" href="classEST__Track.html#a626317b6dddbebc517a40eb546381cba">save</a>(<span class="stringliteral">&quot;tmp/track.est&quot;</span>, <span class="stringliteral">&quot;est&quot;</span>) != <a class="code" href="EST__rw__status_8h.html#a2e09b4ded8fd265d4fb01e3c93e64312a317dc678bf3950bde0350d7f1044c024">write_ok</a>)</div><div class="line">    <a class="code" href="EST__error_8h.html#a77e7718a22033561ee47f8b28b12acac">EST_error</a>(<span class="stringliteral">&quot;can&#39;t save est file\n&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>Save as an ascii file: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">if</span> (tr.<a class="code" href="classEST__Track.html#a626317b6dddbebc517a40eb546381cba">save</a>(<span class="stringliteral">&quot;tmp/track.ascii&quot;</span>, <span class="stringliteral">&quot;ascii&quot;</span>) != <a class="code" href="EST__rw__status_8h.html#a2e09b4ded8fd265d4fb01e3c93e64312a317dc678bf3950bde0350d7f1044c024">write_ok</a>)</div><div class="line">    <a class="code" href="EST__error_8h.html#a77e7718a22033561ee47f8b28b12acac">EST_error</a>(<span class="stringliteral">&quot;can&#39;t save ascii file\n&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>The file type is automatically determined from the file's header during loading:</p>
<p><div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <a class="code" href="classEST__Track.html">EST_Track</a> tr2;</div><div class="line">    <span class="keywordflow">if</span> (tr2.<a class="code" href="classEST__Track.html#a4471356fc756175cdfdf9acd5e5b4a64">load</a>(<span class="stringliteral">&quot;tmp/track.htk&quot;</span>) != <a class="code" href="EST__rw__status_8h.html#a8fd6c9577870f215597b44be5ccd63a3a463ad065208ae2872e60537559a88f56">read_ok</a>)</div><div class="line">    <a class="code" href="EST__error_8h.html#a77e7718a22033561ee47f8b28b12acac">EST_error</a>(<span class="stringliteral">&quot;can&#39;t reload htk\n&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --></p>
<p>If no header is found, the function assumes the file is ascii data, with a fixed frame shift, arranged with rows representing frames and columns channels. In this case, the frame shift must be specified as an argument to this function: <div class="fragment"><div class="line">    <span class="comment">//@ code</span></div><div class="line">    <span class="keywordflow">if</span> (tr.<a class="code" href="classEST__Track.html#a4471356fc756175cdfdf9acd5e5b4a64">load</a>(<span class="stringliteral">&quot;tmp/track.ascii&quot;</span>, 0.01) != <a class="code" href="EST__rw__status_8h.html#a8fd6c9577870f215597b44be5ccd63a3a463ad065208ae2872e60537559a88f56">read_ok</a>)</div><div class="line">    <a class="code" href="EST__error_8h.html#a77e7718a22033561ee47f8b28b12acac">EST_error</a>(<span class="stringliteral">&quot;can&#39;t reload ascii file\n&quot;</span>);</div><div class="line">    <span class="comment">//@ endcode</span></div></div><!-- fragment --> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Oct 6 2017 18:25:31 for Edinburgh Speech Tools by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
